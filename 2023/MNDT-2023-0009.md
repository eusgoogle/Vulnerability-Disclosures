# MNDT-2023-0009
## Description
Atera Agent for Windows contains a local privilege escalation vulnerability which affected versions 1.8.4.8 and prior.

## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges 

## Exploitability
Medium - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce. An attacker would need a user interface to exploit the vulnerability.

## CVE Reference
CVE-2023-26078

## Common Weakness Enumeration
CWE-648: Incorrect Use of Privileged APIs

## Common Vulnerability Scoring System
Base Score: 7.3 - Vector: AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H

## Technical Details

The installation of the agent uses the Windows Installer framework and an MSI file is cached in C:\Windows\Installer. An unprivileged user can trigger a repair operation, either by using the Windows Installer API or by running "msiexec.exe /fa c:\Windows\Installer\[XXXXX].msi".

Running a repair operation will trigger Command Prompt windows to temporarily open from a SYSTEM context. The Command Prompt windows can be frozen by highlighting part of the window with the mouse, which would then give an attacker ample time to access the Properties window containing hyperlinks that can be utilized to open a web browser from a SYSTEM context. 


## Resolution
The issue was fixed in version 1.8.4.9.

## Discovery Credits
- Andrew Oliveau, Mandiant

## Disclosure Timeline
- 28-Feb-2023 - Vulnerability reported to Atera
- 29-Mar-2023 - Vulnerability confirmed by Atera
- 26-Jun-2023 - Vulnerability fixed in version 1.8.4.9
 
## References
- [Escalating Privileges via Third-Party Windows Installers](https://www.mandiant.com/resources/blog/privileges-third-party-windows-installers)
- [Mitre CVE-2023-26078](https://www.cve.org/CVERecord?id=CVE-2023-26078)
