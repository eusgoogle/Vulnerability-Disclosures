# MNDT-2023-0008
## Description
Atera Agent for Windows contains a local privilege escalation vulnerability which affected versions 1.8.3.6 and prior.

## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges 

## Exploitability
Medium - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce

## CVE Reference
CVE-2023-26077

## Common Weakness Enumeration
CWE-379: Creation of Temporary File in Directory with Insecure Permissions

## Common Vulnerability Scoring System
Base Score: 7.8 - Vector: AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

## Technical Details

The installation of the agent uses the Windows Installer framework and an MSI file is cached in C:\Windows\Installer. An unprivileged user can trigger a repair operation, either by using the Windows Installer API or by running "msiexec.exe /fa c:\Windows\Installer\[XXXXX].msi".

Running a repair operation will trigger the AgentPackageUpgradeAgent.exe file to execute as SYSTEM from the C:\Windows\Temp\AteraUpgradeAgentPackage folder. Since the C:\Windows\Temp\AteraUpgradeAgentPackage folder inherits permissions from C:\Windows\Temp, standard users are granted write privileges to it, allowing an attacker to perform a local privilege escalation attack via DLL hijacking.


## Resolution
The issue was fixed in version 1.8.3.7.

## Discovery Credits
- Andrew Oliveau, Mandiant

## Disclosure Timeline
- 28-Feb-2023 - Vulnerability reported to Atera
- 29-Mar-2023 - Vulnerability confirmed by Atera
- 17-Apr-2023 - Vulnerability fixed in version 1.8.3.7
 
## References
- [Escalating Privileges via Third-Party Windows Installers](https://www.mandiant.com/resources/blog/privileges-third-party-windows-installers)
- [Mitre CVE-2023-26077](https://www.cve.org/CVERecord?id=CVE-2023-26077)
