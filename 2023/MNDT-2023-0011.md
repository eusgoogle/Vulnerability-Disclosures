# MNDT-2023-0011
## Description
N-able Take Control Agent versions 7.0.41.1141 and prior are susceptible to a Time-of-Check to Time-of-Use (TOCTOU) race condition attack, allowing an attacker to perform arbitrary file deletions as SYSTEM

## Impact
High - Exploiting the vulnerability could give a local unprivileged attacker SYSTEM level privileges 

## Exploitability
Medium - The exploit would require knowledge of how to perform a TOCTOU race condition attack and how to create pseudo-symlinks

## CVE Reference
CVE-2023-27470

## Common Weakness Enumeration
CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')

## Common Vulnerability Scoring System
Base Score: 8.8 - Vector: AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

## Technical Details

The affected BASupSrvcUpdater.exe application contains a TOCTOU race condition vulnerability that allows standard users to create a pseudo-symlink at C:\ProgramData\GetSupportService_N-Central\PushUpdates, which could be leveraged by an attacker to manipulate the process into performing arbitrary file deletions

## Resolution
The issue was fixed in version 7.0.43

## Discovery Credits
- Andrew Oliveau, Mandiant

## Disclosure Timeline
- 27-Feb-2023 - Vulnerability reported to N-Able
- 15-Mar-2023 - Vulnerability fixed in version 7.0.43
 
## References
- [Deleting Your Way Into SYSTEM: Why Arbitrary File Deletion Vulnerabilities Matter](https://www.mandiant.com/resources/blog/arbitrary-file-deletion-vulnerabilities)
- [Mitre CVE-2023-27470](https://www.cve.org/CVERecord?id=CVE-2023-27470)
- [N-Able](https://www.n-able.com/)
